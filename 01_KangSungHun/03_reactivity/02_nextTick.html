<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>nextTick</title>
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>
<body>
  <pre>
    * nextTick
      - Vue의 DOM 업데이트는 최적화를 위해서 비동기적으로 수행된다.
        -> 데이터가 변경되었다고 해서 즉시 갱신되지 않음
      - 언제 업데이트(갱신) 될까?
        -> 다음 Tick에 업데이트 된다.
    
    * await nextTick()
      - 다음 Tick 될때 까지 기다렸다가 DOM 갱신을 수행
  </pre>
  
  <div id="step1">
    <h1>{{message}}</h1>
    <button @click="updateMessage">메시지 갱신</button>
  </div>
  
  <script>
      const {createApp, ref, nextTick} = Vue;

      createApp({
          setup(){
              const message = ref('Hello, Vue!');

              const updateMessage = async () => {
                  console.log('message 변경 전 : ',
                      document.querySelector('h1').innerText);

                  message.value = "안녕, 뷰!";

                  // 반응형 변수 변경 내역이 반영될 때 까지 다음 틱 대기
                  await nextTick();

                  console.log('message 변경 후 : ',
                      document.querySelector('h1').innerText);
              }

              return {message, updateMessage}
          }

      }).mount('#step1');
  
  </script>

</body>
</html>