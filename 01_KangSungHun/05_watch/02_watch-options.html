<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>
<body>
  <!--
      watch options : watch함수의 3번째 인자로 전달되는 옵션 객체이다.
      이 옵션을 통해 watch의 동작을 세밀하게 제어할 수 있다.
  -->
  <div id="step01">
    <p>{{ num }}</p>
    <button @click="num++">num++</button>
  </div>
  
  <hr>
  <div id="step02">
    <p>{{ num }}</p>
    <button @click="num++">num++</button>
  </div>
  
  <hr>
  <div id="step03">
    <p>나이 : {{ user.age }}</p>
    <button @click="user.age++">age++</button>
  </div>
  
  <hr>
  <div id="step04">
    <p id="pcounter">현재 카운트 : {{ count }}</p>
    <button @click="count++">cout++</button>
  </div>
  
  <hr>
  <div id="step05">
    <p>숫자 : {{ num }}</p>
    <p>더블 : {{ double }}</p>
    <button @click="num++">num++</button>
  </div>
  
  <script>
      const { createApp, ref, watch, computed } = Vue;
      createApp({
          setup() {
              const num = ref(0);
              watch(num, (nv, ov) => {
                  console.log(`nv : ${nv}, ov: ${ov}`);
              }, { immediate : true});
              return {
                  num
              }
          }
      }).mount("#step01");

      createApp({
          setup() {
              const num = ref(0);
              watch(num, (nv, ov) => {
                  console.log(`--> nv : ${nv}, ov: ${ov}`);
              }, { once : true});
              return {
                  num
              }
          }
      }).mount("#step02");

      createApp({
          setup() {
              const user = ref({ name: '이순신', age: 20});
              watch(user, (nv) => {
                  console.log(`age : ${nv.age}`);
              }, { deep: true});
              return {
                  user
              }
          }
      }).mount("#step03");

      createApp({
          setup() {
              const count = ref(0);
              watch(count, (nv) => {
                  const text = document.querySelector('#pcounter').textContent; // 맨처음에는 --> 현재 카운트 : 0
                  // {flush: 'post'} 속성 적용 > 실제 HTML에 적힌 텍스트 : 현재 카운트 : 1
                  console.log(`[flush] 실제 HTML에 적힌 텍스트 : ${text}`);
              }, { flush: 'post'});
              return {
                  count
              }
          }
      }).mount("#step04");

      createApp({
          setup() {
              const num = ref(0);
              const double = computed(() => num.value * 2, {
                  onTrack(event) {
                      console.log(event);
                      console.log(`[onTrack] 데이터 추적 시작 : `, event.key);
                  }
              });
              return {
                  num, double
              }
          }
      }).mount("#step05");
  </script>

</body>
</html>